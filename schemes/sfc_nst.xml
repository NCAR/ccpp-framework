<?xml version='1.0' encoding='utf-8'?>
<scheme module="sfc_nst">
  <subroutine name="sfc_nst_init" />
  <subroutine name="sfc_nst_finalize" />
  <subroutine name="sfc_nst_run">
    <var>
      <name>horizontal_loop_extent</name>
      <units>index</units>
      <id>im</id>
      <rank>0</rank>
      <type>integer</type>
      <description>horizontal loop extent, start at 1</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>vertical_dimension</name>
      <units>index</units>
      <id>km</id>
      <rank>0</rank>
      <type>integer</type>
      <description>vertical layer dimension</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_air_pressure</name>
      <units>Pa</units>
      <id>ps</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface pressure</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>x_wind_at_lowest_model_layer</name>
      <units>m s-1</units>
      <id>u1</id>
      <rank>1</rank>
      <type>real</type>
      <description>x component of surface layer wind</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>y_wind_at_lowest_model_layer</name>
      <units>m s-1</units>
      <id>v1</id>
      <rank>1</rank>
      <type>real</type>
      <description>y component of surface layer wind</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>air_temperature_at_lowest_model_layer</name>
      <units>K</units>
      <id>t1</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface layer mean temperature</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>specific_humidity_at_lowest_model_layer</name>
      <units>kg kg-1</units>
      <id>q1</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface layer mean specific humidity</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sea_surface_foundation_temperature</name>
      <units>K</units>
      <id>tref</id>
      <rank>1</rank>
      <type>real</type>
      <description>reference/foundation temperature</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_drag_coefficient_for_momentum_in_air</name>
      <units>none</units>
      <id>cm</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface exchange coeff for momentum</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_drag_coefficient_for_heat_and_moisture_in_air</name>
      <units>none</units>
      <id>ch</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface exchange coeff heat &amp; moisture</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>air_pressure_at_lowest_model_layer</name>
      <units>Pa</units>
      <id>prsl1</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface layer mean pressure</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>ratio_of_exner_function_between_midlayer_and_interface_at_lowest_model_layer</name>
      <units>ratio</units>
      <id>prslki</id>
      <rank>1</rank>
      <type>real</type>
      <description>Exner function at 1st layer</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sea_land_ice_mask</name>
      <units>flag</units>
      <id>islimsk</id>
      <rank>1</rank>
      <type>integer</type>
      <description>landmask: sea/land/ice=0/1/2</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>longitude</name>
      <units>radians</units>
      <id>xlon</id>
      <rank>1</rank>
      <type>real</type>
      <description>longitude</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sin_of_latitude</name>
      <units>none</units>
      <id>sinlat</id>
      <rank>1</rank>
      <type>real</type>
      <description>sin of latitude</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_wind_stress</name>
      <units>m2 s-2</units>
      <id>stress</id>
      <rank>1</rank>
      <type>real</type>
      <description>wind stress</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_longwave_emissivity</name>
      <units>frac</units>
      <id>sfcemis</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface longwave emissivity</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_downwelling_longwave_flux</name>
      <units>W m-2</units>
      <id>dlwflx</id>
      <rank>1</rank>
      <type>real</type>
      <description>total sky surface downward longwave flux</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_net_downward_shortwave_flux</name>
      <units>W m-2</units>
      <id>sfcnsw</id>
      <rank>1</rank>
      <type>real</type>
      <description>total sky sfc netsw flx into ocean</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>precipitation_amount_in_one_dynamics_time_step</name>
      <units>kg m-2 s-1</units>
      <id>rain</id>
      <rank>1</rank>
      <type>real</type>
      <description>rainfall rate</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>time_step_for_dynamics</name>
      <units>s</units>
      <id>timestep</id>
      <rank>0</rank>
      <type>real</type>
      <description>timestep interval</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>index_of_time_step</name>
      <units>count</units>
      <id>kdt</id>
      <rank>0</rank>
      <type>integer</type>
      <description>time step counter</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>forecast_hour</name>
      <units>none</units>
      <id>solhr</id>
      <rank>0</rank>
      <type>real</type>
      <description>fcst hour at the end of prev time step</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>cosine_of_solar_zenith_angle</name>
      <units>none</units>
      <id>xcosz</id>
      <rank>1</rank>
      <type>real</type>
      <description>cosine of solar zenith angle</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_wind_enhancement_due_to_convection</name>
      <units>m s-1</units>
      <id>ddvel</id>
      <rank>1</rank>
      <type>real</type>
      <description>wind enhancement due to convection</description>
      <kind>kind_phys</kind>
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>flag_for_iteration</name>
      <units>flag</units>
      <id>flag_iter</id>
      <rank>1</rank>
      <type>logical</type>
      <description>flag for iteration</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>flag_for_guess_run</name>
      <units>flag</units>
      <id>flag_guess</id>
      <rank>1</rank>
      <type>logical</type>
      <description>flag for guess run</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>flag_for_nsstm_run</name>
      <units>flag</units>
      <id>nstf_name1</id>
      <rank>1</rank>
      <type>integer</type>
      <description>NSSTM flag: off/uncoupled/coupled=0/1/2</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>vertical_temperature_average_range_lower_bound</name>
      <units>mm</units>
      <id>nstf_name4</id>
      <rank>1</rank>
      <type>integer</type>
      <description>zsea1</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>vertical_temperature_average_range_upper_bound</name>
      <units>mm</units>
      <id>nstf_name5</id>
      <rank>1</rank>
      <type>integer</type>
      <description>zsea2</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>flag_print</name>
      <units>flag</units>
      <id>lprnt</id>
      <rank>0</rank>
      <type>logical</type>
      <description>flag for printing diagnostics to output</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>horizontal_index_of_printed_column</name>
      <units>index</units>
      <id>ipr</id>
      <rank>0</rank>
      <type>integer</type>
      <description>horizontal index of printed column</description>
      <kind />
      <intent>in</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_skin_temperature</name>
      <units>K</units>
      <id>tskin</id>
      <rank>1</rank>
      <type>real</type>
      <description>ocean surface skin temperature</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_skin_temperature_after_iteration</name>
      <units>K</units>
      <id>tsurf</id>
      <rank>1</rank>
      <type>real</type>
      <description>ocean surface skin temperature for guess run</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>diurnal thermocline layer_heat_content</name>
      <units>K m</units>
      <id>xt</id>
      <rank>1</rank>
      <type>real</type>
      <description>heat content in diurnal thermocline layer</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sea_water_salinity</name>
      <units>ppt m</units>
      <id>xs</id>
      <rank>1</rank>
      <type>real</type>
      <description>salinity  content in diurnal thermocline layer</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>diurnal_thermocline_layer_x_current</name>
      <units>m2 s-1</units>
      <id>xu</id>
      <rank>1</rank>
      <type>real</type>
      <description>u-current content in diurnal thermocline layer</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>diurnal_thermocline_layer_y_current</name>
      <units>m2 s-1</units>
      <id>xv</id>
      <rank>1</rank>
      <type>real</type>
      <description>v-current content in diurnal thermocline layer</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>diurnal_thermocline_layer_thickness</name>
      <units>m</units>
      <id>xz</id>
      <rank>1</rank>
      <type>real</type>
      <description>diurnal thermocline layer thickness</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>ocean_mixed_layer_thickness</name>
      <units>m</units>
      <id>zm</id>
      <rank>1</rank>
      <type>real</type>
      <description>mixed layer thickness</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sensitivity_of_dtl_heat_content_to_surface_temperature</name>
      <units>m</units>
      <id>xtts</id>
      <rank>1</rank>
      <type>real</type>
      <description>d(xt)/d(ts)</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sensitivity_of_dtl_thickness_to_surface_temperature</name>
      <units>m K-1</units>
      <id>xzts</id>
      <rank>1</rank>
      <type>real</type>
      <description>d(xz)/d(ts)</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sub-layer_cooling_amount</name>
      <units>K</units>
      <id>dt_cool</id>
      <rank>1</rank>
      <type>real</type>
      <description>sub-layer cooling amount</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sub-layer_cooling_thickness</name>
      <units>m</units>
      <id>z_c</id>
      <rank>1</rank>
      <type>real</type>
      <description>sub-layer cooling thickness</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>coefficient_c_0</name>
      <units>none</units>
      <id>c_0</id>
      <rank>1</rank>
      <type>real</type>
      <description>coefficient1 to calculate d(tz)/d(ts)</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>coefficient_c_d</name>
      <units>none</units>
      <id>c_d</id>
      <rank>1</rank>
      <type>real</type>
      <description>coefficient2 to calculate d(tz)/d(ts)</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>coefficient_w_0</name>
      <units>none</units>
      <id>w_0</id>
      <rank>1</rank>
      <type>real</type>
      <description>coefficient3 to calculate d(tz)/d(ts)</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>coefficient_w_d</name>
      <units>none</units>
      <id>w_d</id>
      <rank>1</rank>
      <type>real</type>
      <description>coefficient4 to calculate d(tz)/d(ts)</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>free_convection_layer_thickness</name>
      <units>m</units>
      <id>d_conv</id>
      <rank>1</rank>
      <type>real</type>
      <description>thickness of free convection layer</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>index_of_dtlm_start</name>
      <units>index</units>
      <id>ifd</id>
      <rank>1</rank>
      <type>real</type>
      <description>index to start dtlm run or not</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>sensible_heat_flux_due_to_rainfall</name>
      <units>W</units>
      <id>qrain</id>
      <rank>1</rank>
      <type>real</type>
      <description>sensible heat flux due to rainfall</description>
      <kind>kind_phys</kind>
      <intent>inout</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_specific_humidity</name>
      <units>kg kg-1</units>
      <id>qsurf</id>
      <rank>1</rank>
      <type>real</type>
      <description>surface air saturation specific humidity</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>upward_heat_flux_in_soil</name>
      <units>W m-2</units>
      <id>gflux</id>
      <rank>1</rank>
      <type>real</type>
      <description>soil heat flux</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_drag_wind_speed_for_momentum_in_air</name>
      <units>m s-1</units>
      <id>cmm</id>
      <rank>1</rank>
      <type>real</type>
      <description>surf mom exch coef time mean surf wind</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_drag_mass_flux_for_heat_and_moisture_in_air</name>
      <units>kg m-2 s-1</units>
      <id>chh</id>
      <rank>1</rank>
      <type>real</type>
      <description>surf h&amp;m exch coef time surf wind &amp; density</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>kinematic_surface_upward_latent_heat_flux</name>
      <units>kg kg-1 m s-1</units>
      <id>evap</id>
      <rank>1</rank>
      <type>real</type>
      <description>kinematic from latent heat flux</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>kinematic_surface_upward_sensible_heat_flux</name>
      <units>K m s-1</units>
      <id>hflx</id>
      <rank>1</rank>
      <type>real</type>
      <description>kinematic sensible heat flux</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
    <var>
      <name>surface_upward_potential_latent_heat_flux</name>
      <units>W m-2</units>
      <id>ep</id>
      <rank>1</rank>
      <type>real</type>
      <description>potential evaporation</description>
      <kind>kind_phys</kind>
      <intent>out</intent>
      <optional>F</optional>
    </var>
  </subroutine>
</scheme>
